---
title: "ã€Žãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«SSL/TLSã€èª­æ›¸ä¼šãƒ¡ãƒ¢ï¼ˆç¬¬2ç« ï¼‰"
emoji: "ðŸ“"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["SSL","TLS","å‹‰å¼·ä¼š","ãƒ¡ãƒ¢"]
published: true
---

å‰ï¼š[ç¬¬1ç« ](https://zenn.dev/hg/articles/a1679382d8e2e92f2a51)ã€€æ¬¡ï¼šç¬¬3ç« 

## ã€Žãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«SSL/TLSã€èª­æ›¸ä¼š

[@kdnakt](https://zenn.dev/kdnakt)ã•ã‚“ãŒä¸»å‚¬ã—ã¦ãã ã£ã¦ã„ã‚‹ã€ç¤¾å†…ã®èª­æ›¸ä¼š/å‹‰å¼·ä¼šã€‚
ã“ã®è¨˜äº‹ã¯ã€ãã®èª­æ›¸ä¼šã§ã®å†…å®¹ã‚’ç°¡å˜ã«ç®‡æ¡æ›¸ãã«ã—ãŸè‡ªåˆ†ç”¨ã®ãƒ¡ãƒ¢ã§ã™ã€‚

~~[@kdnakt](https://zenn.dev/kdnakt)ã•ã‚“ãŒæ›¸ã‹ã‚Œã¦ã„ã‚‹åŒèª­æ›¸ä¼šã®[ã‚¹ã‚¯ãƒ©ãƒƒãƒ—è¨˜äº‹](https://zenn.dev/kdnakt/scraps/1146d7c00cd3ce)ã®ã»ã†ãŒè©³ã—ãã‹ã¤åˆ†ã‹ã‚Šã‚„ã™ã„ã®ã§ã€ãã¡ã‚‰ã‚‚èª­ã‚€ã“ã¨ã‚’ãŠè–¦ã‚ã—ã¾ã™ã€‚~~

å…¨ã¦ã‚’1ã¤ã®è¨˜äº‹ã«ã™ã‚‹ã¨é•·ããªã‚Šã™ãŽã‚‹ã®ã§ã€ç« ã”ã¨ã«åˆ†ã‘ã¾ã™ã€‚

### èª­ã‚€æœ¬ã«ã¤ã„ã¦

- Ivan RistiÄ‡ï¼ˆè‘—ï¼‰é½‹è—¤å­é“ï¼ˆç›£è¨³ï¼‰ ã€Žãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«SSL/TLSã€ï¼ˆãƒ©ãƒ ãƒ€ãƒŽãƒ¼ãƒˆ 2017ï¼‰
- [å‡ºç‰ˆç¤¾ã®å•†å“ç´¹ä»‹ãƒšãƒ¼ã‚¸](https://www.lambdanote.com/products/tls)

# ç¬¬2ç« ã€€ãƒ—ãƒ­ãƒˆã‚³ãƒ«

- TLSã¯ä¸Šä½å±¤ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãŒãªã‚“ã§ã‚ã‚‹ã‹ã‚’å•ã‚ãšã€æŽ¥ç¶šå¿—å‘ï¼ˆãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºå®Ÿã«ç›¸æ‰‹ã«é€ä¿¡ã§ãã‚‹ã€‚UDPã¯æŽ¥ç¶šå¿—å‘ã§ã¯ãªã„ï¼‰ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é€šä¿¡ã‚’å®‰å…¨ã«è¡Œã†ãŸã‚ã®æš—å·åŒ–ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã€‚
- Recordãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼šTLSã®å®Ÿè³ªçš„ãªæœ¬ä½“ã€‚ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ä¸Šã§ã‚„ã‚Šå–ã‚Šã•ã‚Œã‚‹ä½Žãƒ¬ãƒ™ãƒ«ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è»¢é€ã‚’ã™ã¹ã¦æ‹…ã†ã€‚
- TLSãƒ¬ã‚³ãƒ¼ãƒ‰ï¼ãƒ˜ãƒƒãƒ€ï¼‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‡ãƒ¼ã‚¿
- ãƒ˜ãƒƒãƒ€ï¼šã‚³ãƒ³ãƒ†ãƒ³ãƒˆã‚¿ã‚¤ãƒ—ï¼‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼‹ãƒ¬ã‚³ãƒ¼ãƒ‰é•·
- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è»¢é€ï¼šåˆ¥ã®ãƒ¬ã‚¤ãƒ¤ã‹ã‚‰æ¸¡ã•ã‚Œã‚‹ã€æ›¸å¼ãŒæ±ºã¾ã£ã¦ã„ãªã„ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒƒãƒ•ã‚¡ã‚’è»¢é€ã™ã‚‹ã€‚ãƒ¬ã‚³ãƒ¼ãƒ‰ã¯æœ€é•·$2^{14}=16,384$ãƒã‚¤ãƒˆã€‚ã“ã‚Œã‚ˆã‚Šé•·ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯åˆ†å‰²ã•ã‚Œã‚‹ã€‚
- TLSã§ã¯æœ€åˆã®æŽ¥ç¶šã«ãŠã‘ã‚‹ä¸€é€£ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç¾¤ï¼ˆe.g. ãƒãƒ³ãƒ‰ã‚·ã‚§ã‚¤ã‚¯ï¼‰ã¯æš—å·åŒ–ã•ã‚Œãªã„ã€‚
- æš—å·ã‚¹ã‚¤ãƒ¼ãƒˆã«ã‚ˆã£ã¦ã¯æš—å·åŒ–ã¯åˆ©ç”¨ã›ãšã€å®Œå…¨æ€§ã®æ¤œè¨¼ã®ã¿ã‚’è¡Œã†ã‚‚ã®ã‚‚ã‚ã‚‹ã€‚
- TLSã®åœ§ç¸®æ©Ÿèƒ½ã¯ç¾åœ¨ã¯åˆ©ç”¨ã•ã‚Œã¦ã„ãªã„ã€‚HTTPç­‰ã§ã™ã§ã«åœ§ç¸®ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒå¤šãã€ã¾ãŸ2012å¹´ã®CRIMEæ”»æ’ƒã§å¤§æ‰“æ’ƒã‚’å—ã‘ãŸãŸã‚ã€‚
- Recordãƒ—ãƒ­ãƒˆã‚³ãƒ«ãŒæ‹…ã†ã®ã¯ãƒ‡ãƒ¼ã‚¿è»¢é€ã¨æš—å·åŒ–å‡¦ç†ã€‚ä»–ã®æ©Ÿèƒ½ã¯ã™ã¹ã¦ã‚µãƒ–ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§è¡Œã†ã€‚
- ã‚µãƒ–ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯è¿½åŠ ãŒå®¹æ˜“ã§ã‚ã‚Šã€ãã®ãŸã‚TLSã¯æ‹¡å¼µãŒå¯èƒ½ã€‚
- ã‚µãƒ–ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯ãƒã‚´ã‚·ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã•ã‚ŒãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦è‡ªå‹•çš„ã«ä¿è­·ã•ã‚Œã‚‹ã€‚
- TLSãƒ¡ã‚¤ãƒ³ã«ã¯4ã¤ã®ã‚µãƒ–ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãŒè¦å®šã•ã‚Œã¦ã„ã‚‹ã€‚
  - Handshake
  - ChangeCipherSpec
  - ApplicationData
  - Alert
- Handshakeãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼šãƒ‡ãƒ¼ã‚¿é€ä¿¡ã«å…ˆç«‹ã£ã¦æŽ¥ç¶šã‚’ç¢ºç«‹ã™ã‚‹ãŸã‚ã«ã€TLSæŽ¥ç¶šã§ä½¿ã†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒã‚´ã‚·ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã¨èªè¨¼ã‚’è¡Œã†ã€‚é€šå¸¸6ï½ž10ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå¿…è¦ã€‚ã“ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å…ˆé ­ã«ã¯1ãƒã‚¤ãƒˆã®ç¨®é¡žï¼‹3ãƒã‚¤ãƒˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¤ºã™ãƒ˜ãƒƒãƒ€ãŒã¤ãã€‚
- ãƒ•ãƒ«ãƒãƒ³ãƒ‰ã‚·ã‚§ã‚¤ã‚¯
  1. æŽ¥ç¶šã§åˆ©ç”¨ã—ãŸã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã‚µãƒ¼ãƒã®åŒæ–¹ãŒæç¤ºâ†’åˆæ„
  2. è¨¼æ˜Žæ›¸ç­‰ã‚’æç¤ºã—ã¦èªè¨¼ã‚’è¡Œã†
  3. ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¿è­·ã®ãŸã‚ã®ãƒžã‚¹ã‚¿ãƒ¼ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’å…±æœ‰ã™ã‚‹
  4. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç¾¤ãŒæ›¸ãæ›ãˆã‚‰ã‚Œã¦ã„ãªã„ã“ã¨ã‚’æ¤œè¨¼ã™ã‚‹ã€‚
- å…·ä½“çš„ã«ã¯
  1. `ClientHello`(C->S)
  2. `ServerHello`(C<-S)
  3. (`Certificate`)(C<-S)[^1]
  4. (`ServerKeyExchange`)(C<-S)[^1]
  5. `ServerHelloDone`(C<-S)
  6. `ClientKeyExchange`(C->S)
  7. `ChangeCipherSpec`(C->S)[^2]
  8. `Finished`(C->S)
  9. `ChangeCipherSpec`(C<-S)[^2]
  10. `Finished`(C<-S)

[^1]: å¿…é ˆã§ã¯ãªã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
[^2]: ChangeCipherSpecãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

## ãƒ•ãƒ«ãƒãƒ³ãƒ‰ã‚·ã‚§ã‚¤ã‚¯ã®å†…å®¹ã‚’ç´°ã‹ãè¦‹ã¦ã¿ã‚ˆã†

- Javaã§SSL/TLSã‚’ãƒ‡ãƒãƒƒã‚°ã—ãŸã„ã¨ãã¯[ã“ã®ãƒšãƒ¼ã‚¸](https://docs.oracle.com/javase/jp/6/technotes/guides/security/jsse/ReadDebug.html)ãŒå‚è€ƒã«ãªã‚‹
  - å®Ÿè¡Œæ™‚å¼•æ•°ã«`-Djavax.net.debug=all`ã‚’ä»˜ã‘ã‚‹ã¨ãƒãƒ³ãƒ‰ã‚·ã‚§ã‚¤ã‚¯ã¾ã§å«ã‚ãŸãƒ­ã‚°ã‚’åã„ã¦ãã‚Œã‚‹

### `ClientHello`

- æ–°è¦ã®ãƒãƒ³ãƒ‰ã‚·ã‚§ã‚¤ã‚¯ã§å¸¸ã«æœ€åˆã«é€ä¿¡ã•ã‚Œã‚‹
- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå¸Œæœ›ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç¾¤ã¨ãã®å„ªå…ˆåº¦ã‚’ã‚µãƒ¼ãƒã«é€šçŸ¥ã™ã‚‹
- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã™ã‚‹ã®ã¯ä¸‹è¨˜ã®3ãƒ‘ã‚¿ãƒ¼ãƒ³
  - æ–°è¦ã«ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã™ã‚‹
  - å†ãƒã‚´ã‚·ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹
  - ã‚µãƒ¼ãƒèµ·å› ã®å†ãƒã‚´ã‚·ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³è¦æ±‚ã«å¿œãˆã‚‹
- `Version`: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒã‚µãƒãƒ¼ãƒˆã™ã‚‹æœ€è‰¯ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³
- `Random`: 28ãƒã‚¤ãƒˆã®ãƒ©ãƒ³ãƒ€ãƒ å€¤ï¼‹4ãƒã‚¤ãƒˆã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæ™‚åˆ»
  - ãƒ©ãƒ³ãƒ€ãƒ å€¤ãŒå®¹æ˜“ã«æŽ¨å®šã•ã‚Œã‚‹è‡´å‘½çš„ãªè„†å¼±æ€§ãŒ1994å¹´ã«NetScapeã§ç™ºè¦‹ã•ã‚ŒãŸãŸã‚ã€è²§å¼±ãªä¹±æ•°ç”Ÿæˆã«å¯¾ã™ã‚‹é˜²å¾¡ã¨ã—ã¦ç¾åœ¨æ™‚åˆ»ã‚’ä»˜åŠ ã™ã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚
  - ãŸã ã—å®Ÿéš›ã®æ™‚åˆ»ã‚’æŒ¿å…¥ã™ã‚‹ã®ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆã«ãªã‚Šã†ã‚‹ã®ã§ã€ãƒ–ãƒ©ã‚¦ã‚¶ã«ã‚ˆã£ã¦ã¯æ™‚åˆ»ã‚’å°‘ã—å¤‰åŒ–ã•ã›ãŸã‚Šã€å®Œå…¨ã«ãƒ©ãƒ³ãƒ€ãƒ ã«ã—ãŸã‚Šã™ã‚‹ã€‚
  - ã“ã®ãƒ©ãƒ³ãƒ€ãƒ å€¤ã¯ä¸‹è¨˜ã®å½¹å‰²ã‚’æžœãŸã™ã€‚
    - æ¯Žå›žã®ãƒãƒ³ãƒ‰ã‚·ã‚§ã‚¤ã‚¯ã‚’ä¸€æ„ã«ã™ã‚‹
    - ãƒªãƒ—ãƒ¬ã‚¤æ”»æ’ƒã‚’é˜²æ­¢ã™ã‚‹
    - äº¤æ›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã®å®Œå…¨æ€§ã‚’æ¤œè¨¼ã™ã‚‹
- `Session ID`: æœ€åˆã¯æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã™ãŸã‚ã«ç©ºã€‚ä»¥é™ã®æŽ¥ç¶šã§ã¯å†é–‹ã—ãŸã„ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã€‚ã“ã®IDã¯ãƒ©ãƒ³ãƒ€ãƒ ãª32ãƒã‚¤ãƒˆã§ã€ãã‚Œè‡ªä½“ã«ç‰¹ã«æ„å‘³ã¯ãªã„ã€‚
- `Cipher Suites`: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå¯¾å¿œå¯èƒ½ãªæš—å·ã‚¹ã‚¤ãƒ¼ãƒˆãŒåˆ—æŒ™ã•ã‚Œã‚‹ã€‚
- `Compression methods`: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå¯¾å¿œã—ã¦ã„ã‚‹åœ§ç¸®æ–¹æ³•ã‚’åˆ—æŒ™ã™ã‚‹ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯`null`ï¼ˆåœ§ç¸®ã—ãªã„ï¼‰
- `Extensions`: ä»˜åŠ çš„ãªãƒ‡ãƒ¼ã‚¿ã‚’é‹ã¶æ‹¡å¼µ

### `ServerHello`

ã‚µãƒ¼ãƒãŒæ±ºå®šã—ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’é€ã‚Šè¿”ã™ã€‚æ§‹é€ ã¯`ClientHello`ã¨åŒã˜ã€‚

### `Certificate`

ã‚µãƒ¼ãƒã‹ã‚‰ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¸ã¨X.509è¨¼æ˜Žæ›¸ãƒã‚§ãƒ¼ãƒ³ã‚’é‹ã¶ã€‚
ã‚µãƒ¼ãƒè¨¼æ˜Žæ›¸ãŒå…ˆé ­ã«ãã¦ã€ã‚ã¨ã¯ä¸­é–“è¨¼æ˜Žæ›¸ãŒç¶šãã€‚æœ€å¾Œã«ãƒ«ãƒ¼ãƒˆè¨¼æ˜Žæ›¸ãŒæ¥ã‚‹ãŒã€ãƒ«ãƒ¼ãƒˆè¨¼æ˜Žæ›¸ã¯çœç•¥å¯ã€‚

### `ServerKeyExchange`

éµäº¤æ›ã«å¿…è¦ãªä»˜åŠ çš„ãƒ‡ãƒ¼ã‚¿ã‚’é‹ã¶ã€‚æš—å·ã‚¹ã‚¤ãƒ¼ãƒˆã«ã‚ˆã£ã¦ã¯çœç•¥ã•ã‚Œã‚‹ã€‚

### `ServerHelloDone`

ã‚µãƒ¼ãƒãŒã€Œã“ã£ã¡ãŒé€ã‚ŠãŸã„ãƒãƒ³ãƒ‰ã‚·ã‚§ã‚¤ã‚¯ã¯å…¨éƒ¨é€ã£ãŸã‚ˆã€ã¨ã„ã†åˆå›³ã€‚
ä»¥é™ã€ã‚µãƒ¼ãƒã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¾…æ©Ÿã™ã‚‹ã€‚

### `ClientKeyExchange`

éµäº¤æ›ã«å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰é‹ã¶ãŸã‚ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€‚å¿…é ˆã€‚

### `ChangeCipherSpec`

- ã‚µãƒ¼ãƒã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ä¸¡æ–¹ãŒé€ã‚Šã†ã‚‹ã€‚
- ä¸­èº«ã¯`1`ãŒ1ãƒã‚¤ãƒˆã ã‘ã€‚
- ä¸‹è¨˜ã‚’ä¼ãˆã‚‹
  - æŽ¥ç¶šã®ãŸã‚ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿çµ„ã¿ç«‹ã¦ã«å……åˆ†ãªæƒ…å ±ã‚’æ‰‹ã«å…¥ã‚ŒãŸ
  - æš—å·éµã‚’ç”Ÿæˆã—ãŸ
  - ã“ã‚Œã‹ã‚‰æš—å·å‡¦ç†ã«ç§»è¡Œã™ã‚‹
- ãƒãƒ³ãƒ‰ã‚·ã‚§ã‚¤ã‚¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã¯ãªã„ãŸã‚ã€å®Œå…¨æ€§ä¿è¨¼ã®å¯¾è±¡å¤–ã¨ãªã£ã¦ã„ã‚‹ã€‚
  - ã“ã®ã“ã¨ãŒåŽŸå› ã§2014å¹´ã«OpenSSLãŒæ”»æ’ƒã‚’å—ã‘ã‚„ã™ã„çŠ¶æ…‹ã«ãªã£ã¦ã„ãŸã€‚

### `Finished`

- ãƒãƒ³ãƒ‰ã‚·ã‚§ã‚¤ã‚¯ãŒå®Œäº†ã—ãŸåˆå›³
- ã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è‡ªä½“ã¯æš—å·åŒ–ã•ã‚Œã¦ã„ã‚‹
- `verify_data`
  - ãã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å«ã¾ãªã„ã€ãã‚Œã¾ã§ã®å—ä¿¡ã—ãŸãƒãƒ³ãƒ‰ã‚·ã‚§ã‚¤ã‚¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å…¨ã¦ã‚’ãƒãƒƒã‚·ãƒ¥åŒ–ã—ã€ãã‚Œã¨ãƒžã‚¹ã‚¿ãƒ¼ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’çµ„ã¿åˆã‚ã›ã¦ç®—å‡º
  - ã“ã‚Œã«ã‚ˆã‚Šèƒ½å‹•çš„ãªæ”»æ’ƒè€…ã«ã‚ˆã‚‹æé€ ã‚„æ”¹ç«„ãŒä¸å¯èƒ½ã«ãªã‚‹
- TLS1.2ã§ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§12ãƒã‚¤ãƒˆ
  - æš—å·ã‚¹ã‚¤ãƒ¼ãƒˆã«ã‚ˆã£ã¦ã¯ã‚‚ã£ã¨é•·ããªã‚‹

## ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆèªè¨¼

- `CertificateRequest`: ã‚µãƒ¼ãƒã‹ã‚‰ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«å¯¾ã™ã‚‹èªè¨¼ã®è¦æ±‚ã¨ã€è¨±å®¹ã§ãã‚‹è¨¼æ˜Žæ›¸ã®å…¬é–‹éµãŠã‚ˆã³ç½²åã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ä¼é”
- `CertificateVerify`: äº‹å‰ã«é€ã£ãŸã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨¼æ˜Žæ›¸ã«å«ã¾ã‚Œã‚‹å…¬é–‹éµã«å¯¾å¿œã™ã‚‹ç§˜å¯†éµã‚’æŒã£ã¦ã„ã‚‹ã“ã¨ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒè¨¼æ˜Žã™ã‚‹

## ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒªã‚¶ãƒ³ãƒ—ã‚·ãƒ§ãƒ³

- ãƒ•ãƒ«ãƒãƒ³ãƒ‰ã‚·ã‚§ã‚¤ã‚¯ã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å¾€å¾©ãŒå¤šãã€è¨ˆç®—ã‚³ã‚¹ãƒˆã‚‚é«˜ã„ã€‚
- æ—¢ã«ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒç¢ºç«‹ã•ã‚Œã¦ã„ãŸã‚‰ã€çœç•¥ç‰ˆã®ãƒãƒ³ãƒ‰ã‚·ã‚§ã‚¤ã‚¯ã§æ¸ˆã¾ã›ã‚‹ã€‚
  - ã‚µãƒ¼ãƒã¯Session IDã‚’ã‚»ãƒƒã‚·ãƒ§ãƒ³ç¢ºç«‹æ™‚ã®`ServerHello`ã§é€ã£ã¦ãŠã
  1. æ¬¡ã«ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å†é–‹ã™ã‚‹ã¨ãã¯`ClientHello`ã«Session IDã‚’å«ã‚ã¦é€ã‚‹ã€‚
  2. ã‚µãƒ¼ãƒã¯Session IDã‚’å«ã‚ãŸ`ServerHello`ã€æ–°ã—ã„æš—å·éµã€ãã®æš—å·éµã§æš—å·åŒ–ã•ã‚ŒãŸ`Finished`ã‚’é€ã‚‹ã€‚
  3. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒå†é–‹ã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèªã—ãŸã‚‰ã€æš—å·åŒ–ã•ã‚ŒãŸ`Finished`ã‚’é€ã‚‹ã€‚
  4. ã“ã†ã—ã¦ã‚»ãƒƒã‚·ãƒ§ãƒ³å†é–‹æ™‚ã¯1å¾€å¾©ã§ãƒãƒ³ãƒ‰ã‚·ã‚§ã‚¤ã‚¯ãŒå®Œäº†ã•ã‚Œã‚‹
- ä¸Šè¨˜ã®æ–¹æ³•ã§ã¯ã‚µãƒ¼ãƒãŒSession IDã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŒã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§å…¨ã¦ã‚’ä¿æŒã™ã‚‹æ–¹æ³•ã‚‚ã‚ã‚‹
  - session ticketã¨ã„ã†æ–¹æ³•

## éµäº¤æ›

To Be Continued...

å‰ï¼š[ç¬¬1ç« ](https://zenn.dev/hg/articles/a1679382d8e2e92f2a51)ã€€æ¬¡ï¼šç¬¬3ç« 
